<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>WealthPath â€” The Mindset Game</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Montserrat:wght@600;700;800&display=swap" rel="stylesheet" />

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
/* ---------------------------------------------------------
    ROOT BRANDING COLORS
--------------------------------------------------------- */
:root {
    --bg: #020617;
    --blue: #38bdf8;
    --teal: #22e6a6;
    --gold: #facc15;
    --red: #f87171;

    --text: #e5e7eb;
    --muted: #94a3b8;
}

/* ---------------------------------------------------------
    GLOBAL RESET
--------------------------------------------------------- */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    -webkit-tap-highlight-color: transparent;
}

body {
    background: var(--bg);
    color: var(--text);
    font-family: 'Inter', sans-serif;
    overflow-x: hidden;
    user-select: none;
}

/* ---------------------------------------------------------
    ANIMATIONS (Shake & Confetti)
--------------------------------------------------------- */
@keyframes shake {
    0% { transform: translate(1px, 1px) rotate(0deg); }
    10% { transform: translate(-1px, 2px) rotate(-1deg); }
    20% { transform: translate(-3px, 0px) rotate(1deg); }
    30% { transform: translate(3px, 2px) rotate(0deg); }
    40% { transform: translate(1px, -1px) rotate(1deg); }
    50% { transform: translate(-1px, 2px) rotate(-1deg); }
    60% { transform: translate(-3px, 1px) rotate(0deg); }
    100% { transform: translate(0, 0) rotate(0deg); }
}

.shake-anim {
    animation: shake 0.5s;
    color: var(--red) !important; /* Flash red text slightly */
}

/* Confetti Particle */
.confetti-piece {
    position: absolute;
    width: 8px;
    height: 8px;
    background: var(--gold);
    border-radius: 2px;
    pointer-events: none;
    z-index: 50;
}

/* ---------------------------------------------------------
    INTRO CINEMATIC
--------------------------------------------------------- */
#intro-overlay {
    position: fixed;
    inset: 0;
    background: radial-gradient(circle at top, rgba(56,189,248,0.25), transparent 60%), #020617;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 20;
}

#intro-card {
    text-align: center;
    padding: 32px 24px;
    border-radius: 18px;
    border: 1px solid rgba(148,163,184,0.4);
    background: radial-gradient(circle at top, rgba(56,189,248,0.12), rgba(15,23,42,0.98));
    box-shadow: 0 24px 70px rgba(15,23,42,0.9);
    max-width: 360px;
    width: 90%;
}

#intro-logo {
    width: 72px;
    height: 72px;
    border-radius: 999px;
    margin: 0 auto 16px auto;
    background: radial-gradient(circle at center, var(--gold), #eab308, #854d0e);
    box-shadow: 0 0 35px rgba(250,204,21,0.8);
}

#intro-title {
    font-family: 'Montserrat', sans-serif;
    font-size: 1.6rem;
    margin-bottom: 8px;
}

#intro-subtitle {
    font-size: 0.95rem;
    color: var(--muted);
    margin-bottom: 22px;
    line-height: 1.5;
}

#intro-btn {
    margin-top: 6px;
}

/* Fade out animation for intro */
.fade-out {
    animation: fadeOutIntro 0.7s ease forwards;
}
@keyframes fadeOutIntro {
    to {
        opacity: 0;
        pointer-events: none;
        visibility: hidden;
    }
}

/* ---------------------------------------------------------
    PAGE WRAPPER
--------------------------------------------------------- */
#game-container {
    max-width: 600px;
    margin: auto;
    padding: 20px;
    text-align: center;
    transition: transform 0.1s;
}

/* ---------------------------------------------------------
    PARTICLE BACKGROUND (cinematic)
--------------------------------------------------------- */
#particles {
    position: fixed;
    inset: 0;
    z-index: -2;
    background: radial-gradient(circle at center, rgba(56,189,248,0.08), transparent 70%);
    overflow: hidden;
}

.particle {
    position: absolute;
    width: 4px;
    height: 4px;
    background: rgba(255,255,255,0.25);
    border-radius: 50%;
    animation: floatUp linear infinite;
}
@keyframes floatUp {
    from { transform: translateY(100vh); opacity: 0.7; }
    to   { transform: translateY(-10vh); opacity: 0; }
}

/* ---------------------------------------------------------
    GAME HEADER + PROGRESS BAR
--------------------------------------------------------- */
#game-title {
    font-family: 'Montserrat', sans-serif;
    font-size: 2rem;
    margin-top: 15px;
    margin-bottom: 12px;
}

#progress-wrapper {
    margin: 10px auto 8px auto;
    max-width: 420px;
    text-align: left;
}

#progress-label {
    font-size: 0.8rem;
    color: var(--muted);
    margin-bottom: 4px;
}

#progress-bar {
    width: 100%;
    height: 8px;
    border-radius: 999px;
    background: rgba(15,23,42,0.85);
    overflow: hidden;
    border: 1px solid rgba(148,163,184,0.35);
}

#progress-fill {
    height: 100%;
    width: 0%;
    border-radius: inherit;
    background: linear-gradient(90deg, var(--blue), var(--teal));
    transition: width 0.35s ease;
}

/* ---------------------------------------------------------
    ORB DESIGN
--------------------------------------------------------- */
#orb {
    width: 120px;
    height: 120px;
    margin: 30px auto 26px auto;
    border-radius: 50%;
    transition: all 0.4s ease;
    animation: orbPulse 4s ease-in-out infinite;
    position: relative;
}
@keyframes orbPulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.03); }
    100% { transform: scale(1); }
}

/* Orb Stage Colors */
#orb.stage-0 {
    background: radial-gradient(circle at center, var(--blue), #0ea5e9, #0369a1 70%);
    box-shadow: 0 0 25px var(--blue), 0 0 50px var(--blue);
}
#orb.stage-1 {
    background: radial-gradient(circle at center, var(--teal), #0ddbb8, #0b9e84 70%);
    box-shadow: 0 0 30px var(--teal), 0 0 60px var(--teal);
}
#orb.stage-2 {
    background: radial-gradient(circle at center, var(--gold), #eab308, #b45309 70%);
    box-shadow: 0 0 35px var(--gold), 0 0 70px var(--gold);
}

/* Orb Flash on Good Answer */
.orb-good-flash {
    animation: goodFlash 0.3s ease;
}

@keyframes goodFlash {
    0% { transform: scale(1); }
    50% { 
        transform: scale(1.08); 
        box-shadow: 0 0 50px rgba(255,255,255,0.7), 0 0 100px rgba(255,255,255,0.4); 
    }
    100% { transform: scale(1); }
}


/* ---------------------------------------------------------
    FLOATING TEXT FEEDBACK
--------------------------------------------------------- */
.floating-text {
    position: fixed;
    font-family: 'Montserrat', sans-serif;
    font-weight: 700;
    font-size: 1.1rem;
    pointer-events: none;
    z-index: 100;
    text-shadow: 0 2px 8px rgba(0,0,0,0.8);
    animation: floatUpFade 1.5s ease-out forwards;
}

@keyframes floatUpFade {
    0% {
        opacity: 0;
        transform: translateY(10px) scale(0.8);
    }
    15% {
        opacity: 1;
        transform: translateY(0) scale(1.1);
    }
    100% {
        opacity: 0;
        transform: translateY(-60px) scale(1);
    }
}

.ft-pos { color: var(--teal); }
.ft-neg { color: var(--red); }

/* ---------------------------------------------------------
    LEVEL HEADER & QUESTION TEXT
--------------------------------------------------------- */
#level-title {
    font-family: "Montserrat", sans-serif;
    font-size: 1.05rem;
    color: var(--muted);
    margin-bottom: 12px;
}

#question-text {
    font-family: 'Montserrat', sans-serif;
    font-size: 1.2rem;
    margin-bottom: 26px;
    line-height: 1.45;
}

/* ---------------------------------------------------------
    CHOICE BUTTONS
--------------------------------------------------------- */
.choice-btn {
    margin-bottom: 16px;
}

.button {
    cursor: pointer;
    font-size: 1rem;
    border-radius: 16px;
    border: none;
    padding: 2px;
    background: radial-gradient(circle 80px at 80% -10%, #ffffff, #181b1b);
    position: relative;
    width: 100%;
    max-width: 420px;
    display: block;
    margin: 0 auto;
    transition: transform 0.1s ease, box-shadow 0.2s ease, opacity 0.3s, border 0.3s;
}
/* Hover Effect */
.button:hover:not(.disabled) {
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(56, 189, 248, 0.15);
}
.button:active:not(.disabled) {
    transform: scale(0.98);
}
/* DISABLE STATE - IMPORTANT: The logic below removes the need for .correct/.incorrect */
.button.disabled {
    pointer-events: none; 
    /* For non-selected buttons when one is clicked */
    opacity: 0.5; 
}


.button::after {
    content: "";
    position: absolute;
    width: 65%;
    height: 60%;
    border-radius: 120px;
    top: 0;
    right: 0;
    box-shadow: 0 0 20px #ffffff38;
    z-index: -1;
}

.blob1 {
    position: absolute;
    width: 70px;
    height: 100%;
    border-radius: 16px;
    bottom: 0;
    left: 0;
    background: radial-gradient(circle 60px at 0% 100%, #3fe9ff, #0000ff80, transparent);
    box-shadow: -10px 10px 30px #0051ff2d;
}

.blob2 {
    position: absolute;
    width: 60px;
    height: 60%;
    border-radius: 16px;
    top: -8px;
    right: 6%;
    background: radial-gradient(circle 40px at 100% 0%, #ffffff30, transparent);
    pointer-events: none;
}

.inner {
    padding: 14px 18px;
    border-radius: 14px;
    color: #fff;
    z-index: 3;
    position: relative;
    background: radial-gradient(circle 80px at 80% -50%, #777777, #0f1111);
    text-align: left;
    font-family: "Inter", sans-serif;
    font-size: 0.95rem;
    font-weight: 500;
}
.inner::before {
    content: "";
    width: 100%;
    height: 100%;
    left: 0;
    top: 0;
    border-radius: 14px;
    background: radial-gradient(circle 60px at 0% 100%, #00e1ff1a, #0000ff11, transparent);
    position: absolute;
}


/* ---------------------------------------------------------
    LEVEL TRANSITION OVERLAY
--------------------------------------------------------- */
#level-transition {
    position: fixed;
    inset: 0;
    display: none;
    align-items: center;
    justify-content: center;
    z-index: 10;
    pointer-events: none;
}

#level-transition-inner {
    padding: 18px 24px;
    border-radius: 999px;
    background: radial-gradient(circle at top, rgba(56,189,248,0.2), rgba(15,23,42,0.96));
    border: 1px solid rgba(148,163,184,0.5);
    color: var(--text);
    font-family: 'Montserrat', sans-serif;
    font-size: 1rem;
    box-shadow: 0 18px 60px rgba(15,23,42,0.9);
    opacity: 0;
    transform: translateY(20px);
}

.show-level-transition #level-transition {
    display: flex;
}

.show-level-transition #level-transition-inner {
    animation: levelPop 0.8s ease forwards;
}

@keyframes levelPop {
    0% { opacity: 0; transform: translateY(20px) scale(0.95); }
    25% { opacity: 1; transform: translateY(0) scale(1.02); }
    100% { opacity: 0; transform: translateY(-10px) scale(1); }
}

/* ---------------------------------------------------------
    FINAL SCREEN & CHART
--------------------------------------------------------- */
#final-screen {
    display: none;
    margin-top: 24px;
    animation: fadeInFinal 1s ease forwards;
}
@keyframes fadeInFinal {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
}

#final-title {
    font-family: "Montserrat", sans-serif;
    font-size: 1.7rem;
    margin-bottom: 16px;
    color: var(--blue);
}
#chart-container {
    position: relative;
    height: 350px; 
    width: 100%;
    max-width: 500px;
    margin: 0 auto 30px auto;
}

#summary-wrapper {
    display: flex;
    flex-direction: column;
    gap: 30px;
    align-items: center;
}

#final-summary {
    font-size: 1rem;
    color: var(--muted);
    line-height: 1.6;
    max-width: 400px;
}
#final-summary strong {
    color: var(--text);
}


#final-scores { /* List for raw scores */
    width: 100%;
    max-width: 300px;
    list-style: none;
    padding: 10px 0;
    border-top: 1px dashed rgba(148, 163, 184, 0.2);
    border-bottom: 1px dashed rgba(148, 163, 184, 0.2);
    text-align: left;
}
#final-scores li {
    display: flex;
    justify-content: space-between;
    padding: 6px 12px;
    font-weight: 600;
    font-size: 0.9rem;
}
#final-scores .score-val {
    color: var(--teal);
    font-family: 'Montserrat', sans-serif;
    font-weight: 800;
}
</style>
</head>

<body>

<div id="intro-overlay">
    <div id="intro-card">
        <div id="intro-logo"></div>
        <div id="intro-title">WealthPath</div>
        <div id="intro-subtitle">
            Your mindset is the real asset.<br/>
            Every choice you make shapes the path you're walking into.
        </div>

        <div id="intro-btn" class="choice-btn">
            <button class="button" onclick="startGameFromIntro()">
                <div class="blob1"></div>
                <div class="blob2"></div>
                <div class="inner">Begin Your Journey</div>
            </button>
        </div>
    </div>
</div>

<div id="particles"></div>

<div id="level-transition">
    <div id="level-transition-inner"></div>
</div>

<div id="game-container">

    <h1 id="game-title">WealthPath</h1>

    <div id="progress-wrapper">
        <div id="progress-label">Question 0 of 0</div>
        <div id="progress-bar">
            <div id="progress-fill"></div>
        </div>
    </div>

    <div id="orb" class="stage-0"></div>

    <div id="level-title"></div>
    <div id="question-text"></div>

    <div id="choices"></div>

    <div id="final-screen">
        <div id="final-title">Your Mindset Profile</div>
        
        <div id="chart-container">
            <canvas id="statsChart"></canvas>
        </div>

        <div id="summary-wrapper">
            <div id="final-summary"></div>
            <ul id="final-scores"></ul>
        </div>
        
        <div id="final-next-step" style="margin-top: 20px; color: var(--blue); font-weight: 600;"></div>

        <div class="choice-btn" style="margin-top: 20px;">
            <button class="button" onclick="location.reload()">
                <div class="blob1"></div>
                <div class="inner">Play Again</div>
            </button>
        </div>
    </div>

</div>

<script>
/* ---------------------------------------------------------
    AUDIO CONFIGURATION (Optimized for GitHub Pages)
--------------------------------------------------------- */
// Since your site is hosted on GitHub Pages, the relative path 
// 'sounds/filename.mp3' will resolve correctly.
const audioClick = new Audio('sounds/click.mp3'); 
const audioGood  = new Audio('sounds/good.mp3');   
const audioBad   = new Audio('sounds/bad.mp3');   
const audioWin   = new Audio('sounds/win.mp3');   

// Volume Settings
audioClick.volume = 0.3;
audioGood.volume = 0.4;
audioBad.volume = 0.4;
audioWin.volume = 0.5;

function playSound(type) {
  // Using cloneNode(true) allows rapid clicks/effects to overlap
  // The .catch(e=>{}) handles the browser security policy preventing autoplay on first click.
  if (type === 'click') audioClick.cloneNode(true).play().catch(e=>{});
  if (type === 'good')  audioGood.cloneNode(true).play().catch(e=>{});
  if (type === 'bad')   audioBad.cloneNode(true).play().catch(e=>{});
  if (type === 'win')   audioWin.cloneNode(true).play().catch(e=>{});
}

/* ---------------------------------------------------------
    VISUAL EFFECTS: SHAKE & CONFETTI
--------------------------------------------------------- */
function triggerShake() {
    const container = document.getElementById('game-container');
    container.classList.remove('shake-anim'); 
    void container.offsetWidth; 
    container.classList.add('shake-anim');
    
    setTimeout(() => {
        container.classList.remove('shake-anim');
    }, 500);
}

function triggerConfetti() {
    const orb = document.getElementById("orb");
    const rect = orb.getBoundingClientRect();
    const centerX = rect.left + rect.width / 2;
    const centerY = rect.top + rect.height / 2;

    for(let i=0; i<30; i++) {
        const conf = document.createElement("div");
        conf.classList.add("confetti-piece");
        
        const colors = ['#facc15', '#38bdf8', '#22e6a6', '#ffffff'];
        conf.style.background = colors[Math.floor(Math.random()*colors.length)];
        
        conf.style.left = centerX + 'px';
        conf.style.top = centerY + 'px';
        document.body.appendChild(conf);

        const angle = Math.random() * Math.PI * 2;
        const velocity = 100 + Math.random() * 200;
        const tx = Math.cos(angle) * velocity;
        const ty = Math.sin(angle) * velocity;

        conf.animate([
            { transform: `translate(0,0) scale(1)`, opacity: 1 },
            { transform: `translate(${tx}px, ${ty}px) scale(0)`, opacity: 0 }
        ], {
            duration: 800 + Math.random() * 400,
            easing: 'cubic-bezier(0.25, 1, 0.5, 1)',
            fill: 'forwards'
        }).onfinish = () => conf.remove();
    }
}

/* ---------------------------------------------------------
    PARTICLES GENERATION
--------------------------------------------------------- */
function spawnParticles() {
    const container = document.getElementById("particles");
    for (let i = 0; i < 70; i++) {
        const p = document.createElement("div");
        p.classList.add("particle");
        p.style.left = Math.random() * 100 + "vw";
        p.style.animationDuration = (6 + Math.random() * 10) + "s";
        p.style.animationDelay = (-Math.random() * 8) + "s";
        container.appendChild(p);
    }
}
spawnParticles();

/* ---------------------------------------------------------
    GAME DATA (UNCHANGED)
--------------------------------------------------------- */
let orbSize = 120;
let orbStage = 0; // 0 = blue, 1 = teal, 2 = gold

// Initial Attributes
let attributes = {
    focus: 0,
    patience: 0,
    consistency: 0,
    mindset: 0,
    risk: 0,
    trajectory: 0
};

const levels = [
    // --- START LEVEL 1 DATA ---
    {
        title: "Level 1 â€” Daily Focus",
        questions: [
            {
                text: "Itâ€™s the start of your day. Whatâ€™s the very first thing you do for your future self?",
                choices: [
                    { label: "Check my phone, scroll for a bit.", effects: { focus: -1 } },
                    { label: "Write down 1â€“3 intentions for today.", effects: { focus: 4, mindset: 2 } },
                    { label: "Think about money but donâ€™t take action.", effects: { mindset: 1 } }
                ]
            },
            {
                text: "You planned to read 10 pages about investing tonight, but Netflix is calling. What happens?",
                choices: [
                    { label: "I still read, even if Iâ€™m a little tired.", effects: { consistency: 4, focus: 2 } },
                    { label: "Iâ€™ll do it tomorrowâ€¦ probably.", effects: { consistency: 1 } },
                    { label: "Forget it. Iâ€™ve had a long day.", effects: { consistency: -1 } }
                ]
            },
            {
                text: "You sit down to work on your goals. What do you do with notifications?",
                choices: [
                    { label: "Silent mode. My goals come first.", effects: { focus: 5 } },
                    { label: "Leave them on. Iâ€™ll just â€˜ignoreâ€™ them.", effects: { focus: -1 } },
                    { label: "Check them every few minutes.", effects: { focus: -2 } }
                ]
            },
            {
                text: "You start thinking about your money. Whatâ€™s your first honest thought?",
                choices: [
                    { label: "I avoid checking because it stresses me out.", effects: { mindset: -1 } },
                    { label: "Iâ€™m not where I want to be, but Iâ€™m willing to learn.", effects: { mindset: 3 } },
                    { label: "Iâ€™m already planning how to level up.", effects: { mindset: 4, trajectory: 1 } }
                ]
            },
            {
                text: "How do you usually handle your to-do list?",
                choices: [
                    { label: "I keep everything in my head and forget things.", effects: { focus: -1 } },
                    { label: "I write things down but rarely revisit them.", effects: { consistency: 1 } },
                    { label: "I write them down and check them off as I go.", effects: { consistency: 3, focus: 2 } }
                ]
            },
            {
                text: "When you feel overwhelmed, whatâ€™s your go-to response?",
                choices: [
                    { label: "Shut down and do nothing.", effects: { mindset: -2 } },
                    { label: "Do one tiny task to keep momentum.", effects: { mindset: 3, consistency: 2 } },
                    { label: "Complain about it but donâ€™t change anything.", effects: { mindset: -1 } }
                ]
            }
        ]
    },
    // --- START LEVEL 2 DATA ---
    {
        title: "Level 2 â€” Spending & Temptation",
        questions: [
            {
                text: "You get an unexpected $100. What do you genuinely do?",
                choices: [
                    { label: "Buy something Iâ€™ve been wanting right away.", effects: { patience: -1 } },
                    { label: "Split it: a little fun, a little saved/invested.", effects: { patience: 2, trajectory: 2 } },
                    { label: "Add it fully to savings or investments.", effects: { patience: 4, trajectory: 3 } }
                ]
            },
            {
                text: "Thereâ€™s a sale: â€œ50% OFF today only.â€ Whatâ€™s your move?",
                choices: [
                    { label: "If I didnâ€™t plan for it, I skip it.", effects: { patience: 3, mindset: 2 } },
                    { label: "I buy it. Itâ€™s a â€˜dealâ€™, right?", effects: { trajectory: -1 } },
                    { label: "I put it in my cart but wait 24 hours.", effects: { patience: 2 } }
                ]
            },
            {
                text: "A friend invites you out to an expensive dinner last minute.",
                choices: [
                    { label: "I go, even if it ruins my budget.", effects: { trajectory: -2 } },
                    { label: "I suggest something cheaper or another time.", effects: { mindset: 2, patience: 2 } },
                    { label: "I stay home and cook, no guilt.", effects: { patience: 3, focus: 1 } }
                ]
            },
            {
                text: "You see someone online flexing luxury purchases. What do you feel?",
                choices: [
                    { label: "Jealousy. I feel behind.", effects: { mindset: -2 } },
                    { label: "Curious. I wonder what their real situation is.", effects: { mindset: 2 } },
                    { label: "Neutral. Iâ€™m focused on my own path.", effects: { mindset: 3, focus: 2 } }
                ]
            },
            {
                text: "When you swipe your card, how often do you check your balance?",
                choices: [
                    { label: "Rarely. I donâ€™t want to see it.", effects: { mindset: -2 } },
                    { label: "Sometimes, when I remember.", effects: { mindset: 1 } },
                    { label: "Often. I like to know where I stand.", effects: { mindset: 3, focus: 2 } }
                ]
            },
            {
                text: "You realize youâ€™ve been ordering food a lot. What happens next?",
                choices: [
                    { label: "I ignore it. It is what it is.", effects: { trajectory: -2 } },
                    { label: "I set a weekly limit and try again.", effects: { consistency: 2, patience: 2 } },
                    { label: "I plan simple meals I can actually stick to.", effects: { consistency: 3, mindset: 2 } }
                ]
            }
        ]
    },
    // --- START LEVEL 3 DATA ---
    {
        title: "Level 3 â€” Emotions & The Market",
        questions: [
            {
                text: "You finally start investing. The account drops a little the first week.",
                choices: [
                    { label: "Iâ€™m annoyed, but I know itâ€™s normal.", effects: { mindset: 3, risk: 1 } },
                    { label: "I instantly regret starting.", effects: { mindset: -2 } },
                    { label: "I want to add more, but carefully.", effects: { mindset: 3, risk: 2, trajectory: 1 } }
                ]
            },
            {
                text: "Someone tells you, â€œThe stock market is basically gambling.â€",
                choices: [
                    { label: "Maybe theyâ€™re right, I shouldnâ€™t invest.", effects: { mindset: -3 } },
                    { label: "I ask questions and do my own research.", effects: { mindset: 3, focus: 1 } },
                    { label: "I explain the difference between gambling and long-term investing.", effects: { mindset: 4, risk: 1 } }
                ]
            },
            {
                text: "Bad news hits the economy. What do you do with your investments?",
                choices: [
                    { label: "Panic sell. Iâ€™m out.", effects: { risk: -4, trajectory: -3 } },
                    { label: "Do nothing, stick to the plan.", effects: { mindset: 3, patience: 3 } },
                    { label: "Check my allocations, maybe rebalance calmly.", effects: { mindset: 4, risk: 2 } }
                ]
            },
            {
                text: "Your portfolio is finally up. A lot.",
                choices: [
                    { label: "Cash out everything immediately.", effects: { risk: -1, trajectory: -2 } },
                    { label: "Take a small amount, leave the rest invested.", effects: { trajectory: 2, patience: 1 } },
                    { label: "Stay the courseâ€”my plan matters more than short-term gains.", effects: { patience: 3, mindset: 3 } }
                ]
            },
            {
                text: "When you see red days in the market, what best describes you?",
                choices: [
                    { label: "My emotions run the whole show.", effects: { risk: -2 } },
                    { label: "I feel nervous but I donâ€™t react right away.", effects: { mindset: 2 } },
                    { label: "I see them as normal weather, not the whole climate.", effects: { mindset: 4, risk: 2 } }
                ]
            },
            {
                text: "If an investment goes down 20%, whatâ€™s your first move?",
                choices: [
                    { label: "Blame myself and swear off investing.", effects: { mindset: -3 } },
                    { label: "Look at the bigger picture and time horizon.", effects: { mindset: 3, patience: 2 } },
                    { label: "Learn what happened and adjust if needed.", effects: { mindset: 4, focus: 1 } }
                ]
            }
        ]
    },
    // --- START LEVEL 4 DATA ---
    {
        title: "Level 4 â€” Habits & Automation",
        questions: [
            {
                text: "How do you currently approach saving or investing?",
                choices: [
                    { label: "Randomly, when I â€˜feel like itâ€™.", effects: { consistency: -1 } },
                    { label: "I save/invest when extra money shows up.", effects: { consistency: 1 } },
                    { label: "I automate a set amount every month.", effects: { consistency: 4, trajectory: 3 } }
                ]
            },
            {
                text: "You get paid. What happens first?",
                choices: [
                    { label: "Rent, bills, spendingâ€¦ then maybe saving.", effects: { trajectory: 0 } },
                    { label: "I move something into savings/investing first.", effects: { consistency: 3, trajectory: 3 } },
                    { label: "I let it sit and decide later.", effects: { consistency: -1 } }
                ]
            },
            {
                text: "You miss a contribution one month.",
                choices: [
                    { label: "I say, â€˜See? I knew I couldnâ€™t stick to this.â€™", effects: { mindset: -2 } },
                    { label: "I acknowledge it and get back on track next month.", effects: { consistency: 3, mindset: 2 } },
                    { label: "I pause the plan entirely.", effects: { consistency: -3 } }
                ]
            },
            {
                text: "How do you usually learn about money?",
                choices: [
                    { label: "Random TikToks or posts when they pop up.", effects: { focus: -1 } },
                    { label: "Occasional videos and articles when I remember.", effects: { focus: 1 } },
                    { label: "I intentionally follow creators or resources that teach me.", effects: { focus: 3, mindset: 2 } }
                ]
            },
            {
                text: "You start a new money habit. How long do you normally last?",
                choices: [
                    { label: "A few days, then I fall off.", effects: { consistency: -2 } },
                    { label: "A few weeks, then I reset and try again.", effects: { consistency: 1, mindset: 1 } },
                    { label: "Months or longerâ€”Iâ€™m learning to stick with things.", effects: { consistency: 4 } }
                ]
            },
            {
                text: "Whatâ€™s your honest approach to tracking money?",
                choices: [
                    { label: "I donâ€™t track anything.", effects: { focus: -2 } },
                    { label: "I sometimes check, but itâ€™s inconsistent.", effects: { focus: 1 } },
                    { label: "I check on a schedule (weekly/monthly).", effects: { focus: 3, consistency: 2 } }
                ]
            }
        ]
    },
    // --- START LEVEL 5 DATA ---
    {
        title: "Level 5 â€” Risk & Goals",
        questions: [
            {
                text: "How do you feel about taking risk with money?",
                choices: [
                    { label: "I hate risk. Iâ€™d rather do nothing.", effects: { risk: -2, trajectory: -1 } },
                    { label: "I can handle some risk if thereâ€™s a plan.", effects: { risk: 2, mindset: 2 } },
                    { label: "I love risk, even if I donâ€™t fully understand it.", effects: { risk: 1, trajectory: -1 } }
                ]
            },
            {
                text: "Someone pitches a â€˜get rich quickâ€™ scheme.",
                choices: [
                    { label: "Iâ€™m tempted. Fast money sounds good.", effects: { risk: -2, trajectory: -2 } },
                    { label: "I ask a lot of questions and probably say no.", effects: { mindset: 3, risk: 2 } },
                    { label: "Hard pass. Slow and steady is my lane.", effects: { patience: 3, trajectory: 2 } }
                ]
            },
            {
                text: "How clear are your financial goals?",
                choices: [
                    { label: "I donâ€™t really have clear goals yet.", effects: { focus: -1 } },
                    { label: "I have a loose idea, but nothing written.", effects: { focus: 1, mindset: 1 } },
                    { label: "I know my goals and write them somewhere.", effects: { focus: 3, trajectory: 3 } }
                ]
            },
            {
                text: "You think about your â€˜future selfâ€™ 10 years from now.",
                choices: [
                    { label: "I rarely think that far ahead.", effects: { patience: -1 } },
                    { label: "Sometimes I do, but it feels blurry.", effects: { patience: 1 } },
                    { label: "I picture them clearly and try to act for them.", effects: { patience: 3, trajectory: 3 } }
                ]
            },
            {
                text: "If someone asked, â€œWhy are you building wealth?â€, your main answer is:",
                choices: [
                    { label: "To prove people wrong.", effects: { mindset: 1 } },
                    { label: "To feel safer and more free.", effects: { mindset: 3, trajectory: 2 } },
                    { label: "I havenâ€™t really thought about my â€˜whyâ€™.", effects: { mindset: -1 } }
                ]
            },
            {
                text: "When a plan isnâ€™t working fast enough, what do you do?",
                choices: [
                    { label: "Quit and jump to a new idea.", effects: { consistency: -3 } },
                    { label: "Adjust the plan but keep the same goal.", effects: { consistency: 3, mindset: 2 } },
                    { label: "Blame the idea instead of my habits.", effects: { mindset: -1 } }
                ]
            }
        ]
    },
    // --- START LEVEL 6 DATA ---
    {
        title: "Level 6 â€” Life Design & Identity",
        questions: [
            {
                text: "When you say, â€œIâ€™m learning about money,â€ how true is that day-to-day?",
                choices: [
                    { label: "Mostly talk. I rarely take action.", effects: { consistency: -2 } },
                    { label: "Iâ€™m on and off, but I care.", effects: { consistency: 1, mindset: 2 } },
                    { label: "I really am learning and acting, even if itâ€™s small.", effects: { consistency: 3, mindset: 3 } }
                ]
            },
            {
                text: "Your environment (friends, family, social media) mostly:",
                choices: [
                    { label: "Pulls me away from long-term thinking.", effects: { mindset: -2 } },
                    { label: "Is mixed. Some supportive, some not.", effects: { mindset: 1 } },
                    { label: "Supports or inspires growth, or Iâ€™m creating that myself.", effects: { mindset: 3, focus: 2 } }
                ]
            },
            {
                text: "You get invited to something that doesnâ€™t align with your priorities.",
                choices: [
                    { label: "I go anyway. I donâ€™t want to disappoint people.", effects: { focus: -1 } },
                    { label: "Sometimes I say no, but I feel guilty.", effects: { mindset: 1 } },
                    { label: "I say no calmly when it doesnâ€™t fit my path.", effects: { focus: 3, patience: 1 } }
                ]
            },
            {
                text: "When you picture your â€˜wealthyâ€™ version of you, what stands out most?",
                choices: [
                    { label: "The things I own.", effects: { mindset: -1 } },
                    { label: "Freedom, time, and peace.", effects: { mindset: 3, trajectory: 2 } },
                    { label: "Impactâ€”who I can help and lift up.", effects: { mindset: 4, trajectory: 3 } }
                ]
            },
            {
                text: "A year from now, what do you want to be able to say about your habits?",
                choices: [
                    { label: "I thought about change, but didnâ€™t move much.", effects: { consistency: -2 } },
                    { label: "I started, stopped, and restartedâ€”but Iâ€™m still here.", effects: { consistency: 2, mindset: 2 } },
                    { label: "I became the person who shows up for their future.", effects: { consistency: 4, mindset: 4, trajectory: 3 } }
                ]
            },
            {
                text: "Right now, in this moment, which truth feels most like you?",
                choices: [
                    { label: "Iâ€™m not sure who I am with money yet.", effects: { mindset: 0 } },
                    { label: "Iâ€™m in the middle of rewriting my story.", effects: { mindset: 3, focus: 1 } },
                    { label: "I am becoming the person my future self will thank.", effects: { mindset: 4, trajectory: 3 } }
                ]
            }
        ]
    }
];

let currentLevel = 0;
let currentQuestion = 0;
let totalQuestions = 0;
let answeredCount = 0;

levels.forEach(level => {
    totalQuestions += level.questions.length;
});

/* ---------------------------------------------------------
    UPDATE ORB EVOLUTION
--------------------------------------------------------- */
function evolveOrb() {
    orbSize += 6;    
    const orb = document.getElementById("orb");
    orb.style.width = orbSize + "px";
    orb.style.height = orbSize + "px";

    // Color stage changes
    if (orbSize > 160 && orbStage === 0) {
        orbStage = 1;
        orb.classList.remove('stage-0');
        orb.classList.add('stage-1');
        
        playSound('win');
        triggerConfetti();
    }

    if (orbSize > 210 && orbStage === 1) {
        orbStage = 2;
        orb.classList.remove('stage-1');
        orb.classList.add('stage-2');

        playSound('win');
        triggerConfetti();
    }
}

/* ---------------------------------------------------------
    PROGRESS BAR
--------------------------------------------------------- */
function updateProgress() {
    const label = document.getElementById("progress-label");
    const fill = document.getElementById("progress-fill");
    label.textContent = `Question ${answeredCount} of ${totalQuestions}`;
    const pct = (answeredCount / totalQuestions) * 100;
    fill.style.width = pct + "%";
}

/* ---------------------------------------------------------
    RENDER QUESTION
--------------------------------------------------------- */
function renderQuestion() {
    if (currentLevel >= levels.length) {
        endGame();
        return;
    }

    const level = levels[currentLevel];
    const question = level.questions[currentQuestion];

    document.getElementById("level-title").innerText = level.title;
    document.getElementById("question-text").innerText = question.text;

    const choiceBox = document.getElementById("choices");
    choiceBox.innerHTML = "";

    question.choices.forEach((choice, i) => {
        const btn = document.createElement("div");
        btn.classList.add("choice-btn");

        btn.innerHTML = `
            <button class="button" onclick="selectChoice(${i})" style="border: 2px solid transparent;">
                <div class="blob1"></div>
                <div class="blob2"></div>
                <div class="inner">${choice.label}</div>
            </button>
        `;

        choiceBox.appendChild(btn);
    });
}

/* ---------------------------------------------------------
    LEVEL TRANSITION
--------------------------------------------------------- */
function showLevelTransition(nextTitle) {
    const transitionOuter = document.getElementById("level-transition");
    const transitionInner = document.getElementById("level-transition-inner");
    transitionInner.textContent = `Next: ${nextTitle}`;
    document.body.classList.add("show-level-transition");

    setTimeout(() => {
        document.body.classList.remove("show-level-transition");
        renderQuestion();
    }, 900);
}

/* ---------------------------------------------------------
    SPAWN FLOATING TEXT
--------------------------------------------------------- */
function spawnFloatingText(text, type) {
    const el = document.createElement("div");
    el.classList.add("floating-text", type);
    el.innerText = text;

    // Position over the orb
    const orb = document.getElementById("orb");
    const rect = orb.getBoundingClientRect();
    
    // Random offset
    const randX = Math.random() * 40 - 20;    

    el.style.left = (rect.left + rect.width/2 - 30 + randX) + "px";
    el.style.top = (rect.top + rect.height/2 - 20) + "px";

    document.body.appendChild(el);
    
    // Remove after animation
    setTimeout(() => {
        el.remove();
    }, 1500);
}

/* ---------------------------------------------------------
    HANDLE CHOICE
--------------------------------------------------------- */
function selectChoice(index) {
    const level = levels[currentLevel];
    const question = level.questions[currentQuestion];
    const choice = question.choices[index];
    const orb = document.getElementById("orb");
    const allButtons = document.querySelectorAll('.button');
    const clickedButton = allButtons[index];
    
    // Play the button click sound immediately
    playSound('click'); 

    // Disable all buttons immediately
    allButtons.forEach(btn => {
        btn.onclick = null; // Remove the onclick handler
        btn.classList.add('disabled'); // Add the disabled class
        // Apply a neutral focus effect to the selected button
        if (btn === clickedButton) {
            btn.style.border = '2px solid rgba(148, 163, 184, 0.4)'; 
            btn.style.boxShadow = '0 0 10px rgba(148, 163, 184, 0.1)';
            btn.style.opacity = '1';
        }
    });

    // Determine net score, apply attributes, and spawn floating text
    let netScore = 0;
    let delay = 0;

    for (let key in choice.effects) {
        attributes[key] += choice.effects[key];
        netScore += choice.effects[key];
        
        const val = choice.effects[key];
        const sign = val > 0 ? "+" : "";
        const label = key.charAt(0).toUpperCase() + key.slice(1);
        const textClass = val >= 0 ? "ft-pos" : "ft-neg";

        // Spawn visual feedback with slight delay between each stat
        setTimeout(() => {
            spawnFloatingText(`${sign}${val} ${label}`, textClass);
        }, delay);
        delay += 250; // Reduced delay time
    }

    const transitionDelay = 250 + delay; // Total delay needed for feedback animations

    // Sound, Shake, and Orb Flash trigger based on net score
    if (netScore <= 0) {
        playSound('bad');
        triggerShake();
    } else { // netScore > 0
        playSound('good');
        // Orb flash on good choice
        orb.classList.add('orb-good-flash'); 
        setTimeout(() => {
            orb.classList.remove('orb-good-flash');
        }, 300);
    }

    // Only evolve orb if the choice had a net positive score
    if (netScore > 0) {
        evolveOrb();
    }

    // Increase answered count + progress
    answeredCount++;
    updateProgress();

    // Move to next question or level AFTER visual feedback has completed
    setTimeout(() => {
        const isLastQuestionInLevel = currentQuestion === level.questions.length - 1;

        if (isLastQuestionInLevel) {
            currentLevel++;
            currentQuestion = 0;

            if (currentLevel >= levels.length) {
                endGame();
                return;
            }

            // Show level transition for next level
            const nextTitle = levels[currentLevel].title;
            showLevelTransition(nextTitle);
        } else {
            currentQuestion++;
            renderQuestion();
        }
    }, transitionDelay); 
}

/* ---------------------------------------------------------
    START & END GAME LOGIC
--------------------------------------------------------- */
function startGameFromIntro() {
    const intro = document.getElementById("intro-overlay");
    intro.classList.add("fade-out");
    playSound('click');
    
    setTimeout(() => {
        intro.style.display = "none";
        renderQuestion();
        updateProgress();
    }, 700);
}

function endGame() {
    playSound('win');
    triggerConfetti();

    // Hide game elements
    document.getElementById("level-title").style.display = "none";
    document.getElementById("question-text").style.display = "none";
    document.getElementById("choices").style.display = "none";
    document.getElementById("progress-wrapper").style.display = "none";
    document.getElementById("orb").style.display = "none"; 

    // Show final screen
    const finalScreen = document.getElementById("final-screen");
    finalScreen.style.display = "block";

    // 1. Render Chart.js
    renderChart();

    // 2. Generate Summary Text based on scores (Archetype logic with subtitles)
    const summaryEl = document.getElementById("final-summary");
    const nextStepEl = document.getElementById("final-next-step");
    const scoresListEl = document.getElementById("final-scores");

    let summaryHTML = "";
    let archetypeTitle;
    let archetypeSubtitle;
    let minScore = Infinity;
    let weakestAttribute = '';
    let scoresHTML = "";

    // Archetype logic
    if (attributes.mindset > 15 && attributes.consistency > 10) {
        archetypeTitle = `<strong>The Architect.</strong>`;
        archetypeSubtitle = `Master of Habits.`;
        summaryHTML = `You have built a rock-solid foundation. Your mindset is your greatest asset, and your consistency ensures you will reach your goals.`;
    } else if (attributes.risk > 10 && attributes.trajectory > 10) {
        archetypeTitle = `<strong>The Visionary.</strong>`;
        archetypeSubtitle = `The Calculated Builder.`;
        summaryHTML = `You are willing to take calculated risks and have your eyes on the big picture. Watch your patience, but trust your gut.`;
    } else if (attributes.focus < 5 || attributes.consistency < 5) {
        archetypeTitle = `<strong>The Dreamer.</strong>`;
        archetypeSubtitle = `Awaiting Action.`;
        summaryHTML = `You have great potential, but your habits aren't supporting your dreams yet. Focus on small, daily consistencies to level up.`;
    } else {
        archetypeTitle = `<strong>The Apprentice.</strong>`;
        archetypeSubtitle = `The Committed Learner.`;
        summaryHTML = `You are on the path. You made some good choices and some learning mistakes. Keep refining your daily habits.`;
    }
    
    summaryEl.innerHTML = `${archetypeTitle}<br><span style="color: var(--teal); font-weight: 700;">${archetypeSubtitle}</span><br><br>${summaryHTML}`;

    // 3. Render Raw Score Values and determine weakest attribute
    for (const [key, value] of Object.entries(attributes)) {
        const label = key.charAt(0).toUpperCase() + key.slice(1);
        scoresHTML += `<li>${label}<span class="score-val">${value}</span></li>`;

        // Track weakest attribute for next step
        if (value < minScore) {
            minScore = value;
            weakestAttribute = label;
        }
    }
    scoresListEl.innerHTML = scoresHTML;

    // 4. Actionable Next Step (Based on the lowest score)
    if (weakestAttribute === 'Focus') {
        nextStepEl.innerHTML = `ðŸŽ¯ **Your next step:** To enhance your ${weakestAttribute}, try eliminating one distraction (like notifications) for 30 minutes every day.`;
    } else if (weakestAttribute === 'Consistency') {
        nextStepEl.innerHTML = `ðŸ” **Your next step:** To build ${weakestAttribute}, make your commitment so small you can't say no. Do 5 minutes of focused work daily.`;
    } else if (weakestAttribute === 'Patience') {
        nextStepEl.innerHTML = `â³ **Your next step:** To improve ${weakestAttribute}, institute a 48-hour delay before making any non-essential purchase.`;
    } else if (weakestAttribute === 'Mindset') {
        nextStepEl.innerHTML = `ðŸ§  **Your next step:** To strengthen your ${weakestAttribute}, journal one financial victory (big or small) every week to build confidence.`;
    } else if (weakestAttribute === 'Risk') {
        nextStepEl.innerHTML = `âš–ï¸ **Your next step:** To manage ${weakestAttribute}, research one low-risk, diversified investment strategy (like an index fund) this week.`;
    } else if (weakestAttribute === 'Trajectory') {
        nextStepEl.innerHTML = `ðŸ”­ **Your next step:** To clarify your ${weakestAttribute}, write down three concrete, measurable goals for the next 12 months.`;
    }
}

function renderChart() {
    const ctx = document.getElementById('statsChart').getContext('2d');
    
    // Prepare data
    const labels = Object.keys(attributes).map(k => k.charAt(0).toUpperCase() + k.slice(1));
    const dataValues = Object.values(attributes);

    // Chart Configuration
    new Chart(ctx, {
        type: 'radar',
        data: {
            labels: labels,
            datasets: [{
                label: 'Mindset Score',
                data: dataValues,
                backgroundColor: 'rgba(34, 230, 166, 0.2)', // Teal with opacity
                borderColor: '#22e6a6', // Solid Teal
                pointBackgroundColor: '#38bdf8', // Blue dots
                pointBorderColor: '#fff',
                pointHoverBackgroundColor: '#fff',
                pointHoverBorderColor: '#38bdf8',
                borderWidth: 2
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: {
                r: {
                    angleLines: {
                        color: 'rgba(148, 163, 184, 0.2)'
                    },
                    grid: {
                        color: 'rgba(148, 163, 184, 0.2)'
                    },
                    pointLabels: {
                        color: '#e5e7eb', // Text color
                        font: {
                            family: 'Montserrat',
                            size: 11,
                            weight: '600'
                        }
                    },
                    ticks: {
                        display: false,
                        backdropColor: 'transparent'
                    },
                    suggestedMin: 0, 
                    suggestedMax: 25 // Set max for consistent scale
                }
            },
            plugins: {
                legend: {
                    display: false
                }
            }
        }
    });
}
</script>
</body>
</html>